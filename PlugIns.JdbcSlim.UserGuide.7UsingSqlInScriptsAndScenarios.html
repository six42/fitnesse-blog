<html><head><title>PlugIns.JdbcSlim.UserGuide.7UsingSqlInScriptsAndScenarios</title><meta http-equiv='Content-Type' content='text/html;charset=UTF-8'/><link rel='stylesheet' type='text/css' href='css/fitnesse.css'/><script src='javascript/jquery-1.11.3.min.js' type='text/javascript'></script><script src='javascript/fitnesse.js' type='text/javascript'></script></head><body><header><h2>PlugIns.JdbcSlim.UserGuide.7UsingSqlInScriptsAndScenarios</h2></header><article><h2><a href="PlugIns.html">PlugIns</a>
<a href="PlugIns.JdbcSlim.html">JdbcSlim</a>
<a href="PlugIns.JdbcSlim.UserGuide.html">UserGuide</a>
</h2></br><br/><div class="contents">
	<b>Contents:</b>
	<ul class="toc1">
		<li>
			<a href="PlugIns.JdbcSlim.UserGuide.7UsingSqlInScriptsAndScenarios.SymbolAssignmentOfResults.html" class="test">Symbol Assignment Of Results +</a>
		</li>
	</ul>
</div>
<br/><br/>This page demonstrates the SQL Command fixture in a script and a scenario.<br/>The scenario uses two  queries.<br/>It also shows additional methods available to analyse the returned data.<br/><br/><h1>Calling the SQLCommand directly in a Script</h1>
<br/><table>
	<tr>
		<td>Define Properties</td>
		<td>ScriptDefinition</td>
	</tr>
	<tr>
		<td>key</td>
		<td>value</td>
	</tr>
	<tr>
		<td>.include</td>
		<td>TestDatabase</td>
	</tr>
	<tr>
		<td>cmd</td>
		<td>select * from TestData</td>
	</tr>
</table>
<br/><table>
	<tr>
		<td>Script</td>
		<td>SQLCommand</td>
		<td>ScriptDefinition</td>
	</tr>
	<tr>
		<td colspan="3">openConnection</td>
	</tr>
	<tr>
		<td colspan="3">execute</td>
	</tr>
	<tr>
		<td>show</td>
		<td colspan="2">success</td>
	</tr>
	<tr>
		<td>show</td>
		<td colspan="2">rawResult</td>
	</tr>
	<tr>
		<td>show</td>
		<td colspan="2">resultSheet</td>
	</tr>
	<tr>
		<td>$RSOne=</td>
		<td colspan="2">resultSheet</td>
	</tr>
	<tr>
		<td colspan="3">closeConnection</td>
	</tr>
</table>
<br/><h1>Calling the SQLCommand directly in a Script (simplified syntax)</h1>
When just executing a single SQL statement (or when connection re-use is enabled) one can ommit the the 'openConnection' and 'closeConnection' commands.<br/>The 'run' command will turn red if the query failes (similar to a call to 'success' after 'execute')<br/><br/><table>
	<tr>
		<td>Script</td>
		<td>SQLCommand</td>
		<td>ScriptDefinition</td>
	</tr>
	<tr>
		<td>run</td>
		<td colspan="2">select * from TestData</td>
	</tr>
	<tr>
		<td>show</td>
		<td>getColumnValueByName</td>
		<td>NAME</td>
	</tr>
	<tr>
		<td>show</td>
		<td colspan="2">rawResult</td>
	</tr>
	<tr>
		<td>show</td>
		<td colspan="2">resultSheet</td>
	</tr>
	<tr>
		<td>$RSOne=</td>
		<td colspan="2">resultSheet</td>
	</tr>
</table>
<br/><h1>Using SQLCommand in a scenario</h1>
<br/><h2>The Scenario with two execute statements</h2>
<br/><p class="note"><a href="PlugIns.JdbcSlim.UserGuide.4TheMappingBetweenTestDataAndCommands.ReadableLongCommands.html">Readable SQL</a> can also be used in a script, to make it easier to edit the wiki page with more complex SQL.</p><span class="meta">variable defined: SQL= {{{
select *
from TestData
where ID = '@id'
}}} </span>
<br/><br/><table>
	<tr>
		<td>Scenario</td>
		<td>The Id</td>
		<td>id</td>
		<td>isNamed</td>
		<td>name</td>
		<td>andHasPhone</td>
		<td>phone</td>
	</tr>
	<tr>
		<td>execute</td>
		<td colspan="6">select Name from TestData where ID = '@id'</td>
	</tr>
	<tr>
		<td>show</td>
		<td colspan="6">success</td>
	</tr>
	<tr>
		<td>show</td>
		<td colspan="6">rawResult</td>
	</tr>
	<tr>
		<td>show</td>
		<td colspan="6">resultSheet</td>
	</tr>
	<tr>
		<td>check</td>
		<td>getColumnValueByName</td>
		<td>NAME</td>
		<td colspan="4">@name</td>
	</tr>
	<tr>
		<td colspan="7"># use preformatted SQL</td>
	</tr>
	<tr>
		<td>execute</td>
		<td colspan="6"><pre>
select *
from TestData
where ID = '@id'
</pre></td>
	</tr>
	<tr>
		<td>show</td>
		<td colspan="6">success</td>
	</tr>
	<tr>
		<td>show</td>
		<td colspan="6">rawResult</td>
	</tr>
	<tr>
		<td>show</td>
		<td colspan="6">resultSheet</td>
	</tr>
	<tr>
		<td>check</td>
		<td>getColumnValueByName</td>
		<td>Phone</td>
		<td colspan="4">@phone</td>
	</tr>
</table>
<br/><br/><br/><h2>Start the test</h2>
<h3>Open a connection</h3>
<table>
	<tr>
		<td>Script</td>
		<td>SQLCommand</td>
		<td>ScriptDefinition</td>
	</tr>
	<tr>
		<td colspan="3">openConnection</td>
	</tr>
</table>
<br/><br/><h3>Call the scenario in a Decision Table</h3>
<br/><table>
	<tr>
		<td colspan="3">The Id  Is Named And Has Phone</td>
	</tr>
	<tr>
		<td>id</td>
		<td>name</td>
		<td>phone</td>
	</tr>
	<tr>
		<td>2</td>
		<td>Ben</td>
		<td>&gt;0</td>
	</tr>
	<tr>
		<td>4</td>
		<td>Till</td>
		<td>&gt;100</td>
	</tr>
	<tr>
		<td>3</td>
		<td>Tom</td>
		<td>&gt;10</td>
	</tr>
	<tr>
		<td>2</td>
		<td>=~/Be/</td>
		<td>&gt;5</td>
	</tr>
</table>
<br/><h3>Call the scenario in a Script Table</h3>
<br/><table>
	<tr>
		<td colspan="6">script</td>
	</tr>
	<tr>
		<td>TheId</td>
		<td>5</td>
		<td>IsNamed</td>
		<td>Sarah</td>
		<td>AndHasPhone</td>
		<td>999999</td>
	</tr>
</table>
<br/><br/><h3>Close the connection</h3>
<table>
	<tr>
		<td>Script</td>
	</tr>
	<tr>
		<td>closeConnection</td>
	</tr>
</table>
</article></body></html>